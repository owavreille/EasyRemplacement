  <div class="row">
    <div class="col">
      <div class="card shadow m-3">
        <h2 class="card-header">Tableau de Suivi des Remplacements</h2>
        <div class="card-body">
          <div class="past-events">
            <h4>Remplacements Passés</h4>
                <div class="table-responsive">
            <table class="table table-striped">
              <thead class="thead-dark">
                <tr class="table-primary">

                  <th>Site</th>
                  <th>Date</th>
                  <th>Médecin Remplacé</th>
                  <th>Début</th>
                  <th>Fin</th>
                  <th>Nb de Patients</th>
                  <th>Aide de Cs</th>
                  <th>Nom du Remplaçant</th>
                  <th>Montant</th>
                  <th>Taux Reversion</th>
                  <th>Montant à Reverser</th>
                </tr>
              </thead>
              <tbody>
                <% @past_events.each do |event| %>
                  <tr>
                    <td><%= event.site.name %></td>
                    <td><%= event.start_time.strftime("%d/%m/%Y") %></td>
                    <td><%= event.doctor.first_name %> <%= event.doctor.last_name %></td>
                    <td><%= event.start_time.strftime("%H:%M") %></td>
                    <td><%= event.end_time.strftime("%H:%M") %></td>
                    <td><%= event.number_of_patients %></td>
                    <td><%= event.helper ? 'oui' : 'non' %></td>
                    <td><%= event.user.first_name %> <%= event.user.last_name %></td>
                  <td>
  <%= form_with(url: update_amount_data_path(event), method: :patch, remote: true, class: 'form-inline') do |form| %>
    <div class="row">
      <div class="col">
        <div class="form-group">
          <%= form.text_field :amount, class: 'form-control form-control-sm', value: event.amount %>
        </div>
      </div>
      <div class="col">
        <%= form.submit 'Ok', class: 'btn btn-primary btn-sm' %>
      </div>
    </div>
  <% end %>
</td>


                    <td><%= event.reversion %> % </td>
                    <td><%= event.amount_paid %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            </div>
            <div class="text-end m-3">
              <% if @past_pagy.present? %>
              <%== pagy_bootstrap_nav(@past_pagy) %>
              <% end %>
</div>
          </div>

          <div class="upcoming-events mt-5">
            <h4>Remplacements à Venir</h4>
                <div class="table-responsive">
            <table class="table table-striped">
              <thead class="thead-dark">
                <tr class="table-primary">
                  <th>Site</th>
                  <th>Date</th>
                  <th>Médecin Remplacé</th>
                  <th>Début</th>
                  <th>Fin</th>
                  <th>Nb de Patients</th>
                  <th>Aide de Cs</th>
                  <th>Nom du Remplaçant</th>
                  <th>Taux Reversion</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <% @upcoming_events.each do |event| %>
                  <tr>
                    <td><%= event.site.name %></td>
                    <td><%= event.start_time.strftime("%d/%m/%Y") %></td>
                    <td>Dr <%= event.doctor.first_name %> <%= event.doctor.last_name %></td>
                    <td><%= event.start_time.strftime("%H:%M") %></td>
                    <td><%= event.end_time.strftime("%H:%M") %></td>
                    <td><%= event.number_of_patients %></td>
                    <td><%= event.helper ? 'oui' : 'non' %></td>
                    <td><%= event.user&.first_name %> <%= event.user&.last_name %></td>
                    <td><%= event.reversion %> % </td>
                   <td>
  <div class="d-inline-flex">
    <%= form_with url: generate_contract_path(event), method: :post do |form| %>
      <%= form.hidden_field :user_id, value: event.user_id %>
      <%= form.hidden_field :doctor_id, value: event.doctor_id %>
      <%= form.hidden_field :site_id, value: event.site_id %>
      <%= form.submit "Générer le Contrat", class: "btn btn-primary m-1" %>
    <% end %>
    <% if event.contract_blob.attached? %>
      <%= link_to download_contract_path(event.id), class: 'btn btn-success m-1', target: "_blank" do %>
        <i class="bi bi-eye"></i>
      <% end %>
    <% else %>
      <p>Aucun contrat</p>
    <% end %>
  </div>
</td>

                  </tr>
                <% end %>
              </tbody>
            </table>
            </div>
            <div class="text-end m-3">
              <% if @upcoming_pagy.present? %>
              <%== pagy_bootstrap_nav(@upcoming_pagy) %>
              <% end %>
            </div>
          </div>
        </div>
      
    
  <div class="text-end m-3">
  <%= link_to "Retour", root_path, class: "btn btn-success" %>
</div>
</div>
</div>
  </div>